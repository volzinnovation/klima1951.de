<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Avro File Reader</title>
  <!-- avsc 5.7.7 UMD build for browser -->
  <script src="https://unpkg.com/avsc@5.7.7/dist/avsc.min.js"></script> <!--  [oai_citation:0‡npmjs.com](https://www.npmjs.com/package/avsc?utm_source=chatgpt.com) [oai_citation:1‡unpkg.com](https://unpkg.com/?utm_source=chatgpt.com) -->
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    pre { background: #f5f5f5; padding: 1rem; border-radius: 4px; overflow: auto; }
  </style>
</head>
<body>
  <h1>Avro File Reader</h1>
  <p>
    Click the button below to fetch and parse <code>1951.avro</code> from this same directory.
  </p>
  <button id="loadBtn">Load and Parse Avro</button>
  <pre id="output">Waiting for action…</pre>

  <script>
    const avro = window.avsc;
    document.getElementById('loadBtn').addEventListener('click', () => {
      const out = document.getElementById('output');
      out.textContent = 'Loading…';

      fetch('1951.avro')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
          }
          return response.arrayBuffer();
        })
        .then(buffer => {
          // Create a BlockDecoder for Avro container files
          const decoder = new avro.streams.BlockDecoder();
          const records = [];

          decoder.on('data', record => records.push(record));
          decoder.on('end', () => {
            out.textContent = JSON.stringify(records, null, 2);
          });
          decoder.on('error', err => {
            out.textContent = `Decode error: ${err.message}`;
          });

          // Feed the raw bytes to the decoder
          decoder.end(new Uint8Array(buffer));
        })
        .catch(error => {
          document.getElementById('output').textContent = `Error: ${error.message}`;
        });
    });
  </script>
</body>
</html>